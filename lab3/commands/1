-- columns name from country table and column number of borders
SELECT c.name, COUNT(DISTINCT neighbor) AS num_borders 
FROM (
    -- match country1 with neighbor 
    SELECT 
        country1 AS country, 
        country2 AS neighbor
    FROM 
        borders

    -- add all bidirectional relationships as two rows
    UNION ALL

    -- match country2 with neighbor 
    SELECT 
        country2 AS country, 
        country1 AS neighbor
    FROM 
        borders
) AS all_borders        -- table all_borders created from subquery thing
JOIN 
    country c ON c.code = all_borders.country      -- join country with all_borders table using country code
GROUP BY 
    c.name                                     -- group by countryname 
HAVING 
    COUNT(DISTINCT neighbor) = 1;                 -- with only one distinct neighbor